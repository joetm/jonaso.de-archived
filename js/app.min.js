function contains(e,t){"use strict";for(var n=e.length;n;)if(n-=1,e[n]===t)return!0;return!1}function browserSupportsCSSProperty(e){"use strict";var t,n,o,a=document.createElement("div");if(e=e.toLowerCase(),void 0!==a.style[e])return!0;for(n=e.charAt(0).toUpperCase()+e.substr(1),o="Webkit Moz ms O".split(" "),t=0;t<o.length;t++)if(void 0!=a.style[o[t]+n])return!0;return!1}function init_map(){L.Icon.Default.imagePath="./js/vendor/leaflet/images";var e=L.icon({iconUrl:"./js/vendor/leaflet/images/marker-icon-gray.png",shadowUrl:"./js/vendor/leaflet/images/marker-shadow.png",iconSize:[18,30],shadowSize:[30,30],iconAnchor:[9,30],shadowAnchor:[9,30],popupAnchor:[9,-3]}),t=L.tileLayer("http://{s}.tile.osm.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'}),n=L.latLng(51,4),o=0,a=!0,i=L.map("location-map",{center:n,zoom:4,layers:[t]});for(o=0;num_places>o;o++)a?(a=!1,L.marker([places[o].lat,places[o].lng]).addTo(i).bindPopup("<b>"+places[o].city+"</b><br />"+places[o].country).openPopup()):L.marker([places[o].lat,places[o].lng],{icon:e}).addTo(i)}var app={},places,words,countries=[],i=0,num_places=0,num_countries=0,map={};app.finished=!1,$(app).on("ajax:done",function(){console.log("custom ajax:done event"),app.finished=!0,(new WOW).init()}),$(function(){$.ajax({url:"data/data.json",dataType:"json",cache:!1}).done(function(e){for(places=e.places,words=e.words,num_places=places.length,i=0;num_places>i;i+=1)contains(countries,places[i].country)||countries.push(places[i].country);num_countries=countries.length,init_map(),$("#tagcloud").jQCloud(words,{removeOverflowing:!1,autoResize:!0})}).fail(function(e,t){"parsererror"===t?console.log("malformed json in data.json"):console.log("ajax failed",t)})});var MiniCVModel=Backbone.Model.extend({urlRoot:"./data/mini-cv.json"}),MiniCVCollection=Backbone.Collection.extend({idAttribute:"_id",url:"./data/mini-cv.json",model:MiniCVModel}),miniCVstations=new MiniCVCollection,MiniCVView=Backbone.View.extend({collection:miniCVstations,el:$("#cv .timeline"),tagName:"li",initialize:function(){this.loadTemplate()},template:!1,loadTemplate:function(){var e=this;$.get("./views/minicv.htm",function(t){Mustache.parse(t),e.template=t,e.render()})},itemNo:0,renderTemplate:function(e){return this.itemNo++,e=e.toJSON(),this.itemNo%2!==0?(e.li_class=" timeline-inverted",e.timeline_body_alternation="slideInRight"):(e.li_class="",e.timeline_body_alternation="slideInLeft"),Mustache.render(this.template,e)},htmlContent:"",render:function(){var e=this;this.collection.fetch().done(function(){e.collection.each(function(t){e.htmlContent+=e.renderTemplate(t)}),e.$el.prepend(e.htmlContent)}),$(app).trigger("ajax:done")}}),miniCVview=new MiniCVView;$(function(){$("#komasurfer-link").attr("href","http://komasurfer.com/portfolio/"),$("img.lazy").lazyload({threshold:200}),$("footer .copyright").append(" "+(new Date).getFullYear()),$("#map .num_countries").text(num_countries);var e=!1,t=Math.floor(Date.now()/1e3);$.ajax({dataType:"text",method:"POST",url:"./token.php",data:{d:t}}).done(function(t){t&&(e=t)}),$("#simple_form-field-submit").click(function(n){return n.preventDefault(),e&&t&&$.ajax({dataType:"text",url:"http://komasurfer.com/contact.php",data:{token:e,name:$("#simple_form-field-name").val(),email:$("#simple_form-field-email").val(),message:$("#simple_form-field-message").val(),dateline:t}}).done(function(){$("#simple_form-success").html("<div class='alert alert-success'>"),$("#simple_form-success > .alert-success").html("<button type='button' class='close' data-dismiss='alert' aria-hidden='true'>&times;").append("</button>"),$("#simple_form-success > .alert-success").append("<strong>Your message has been sent.</strong>"),$("#simple_form-success > .alert-success").append("</div>"),$(".form-group").remove()}),!1})});